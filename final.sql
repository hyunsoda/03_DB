

INSERT INTO ITEM_CATEGORY VALUES(1,'차');
INSERT INTO ITEM_CATEGORY VALUES(2,'캠핑용품');
INSERT INTO ITEM_CATEGORY VALUES(3,'패키지');

 INSERT INTO CAR_LOCATION VALUES (1,'서울');
 INSERT INTO CAR_LOCATION VALUES (2,'부산');
 
INSERT INTO CAR_GRADE VALUES(1,'소형');
INSERT INTO CAR_GRADE VALUES(2,'중형');
INSERT INTO CAR_GRADE VALUES(3,'대형');
INSERT INTO CAR_GRADE VALUES(4,'캠핑카');


INSERT INTO ITEM VALUES (1,1,5);
INSERT INTO ITEM VALUES (2,1,5);

INSERT INTO CAR VALUES (1,2,6,4,'소나타',100000,DEFAULT);
INSERT INTO CAR VALUES (2,3,8,6,'산타페',200000, DEFAULT);


INSERT INTO CAR_STOCK  VALUES(1,1,'11가 1111',DEFAULT, DEFAULT, 1);
INSERT INTO CAR_STOCK  VALUES(5,1,'55가 5555',DEFAULT, 1);
INSERT INTO CAR_STOCK  VALUES(2,2,'22가 2222',DEFAULT, DEFAULT, 1 );
INSERT INTO CAR_STOCK  VALUES(3,1,'33가 3333', DEFAULT, DEFAULT, 2);
INSERT INTO CAR_STOCK  VALUES(4,2, '44가 4444',DEFAULT, DEFAULT, 2);
SELECT * FROM CAR_STOCK cs ;

COMMIT;

SELECT DISTINCT (ITEM_NO), CAR_STOCK_NO,CAR_ID, CAR_NAME, CAR_FUEL, CAR_GRADE_NAME, CAR_RENT_CHECK, CAR_LOCATION_NAME, 
CAR_PASSENGERS, CAR_SLEEP_CAPACITY, CAR_RENT_PRICE
FROM CAR NATURAL JOIN ITEM 
NATURAL JOIN CAR_STOCK NATURAL JOIN CAR_GRADE NATURAL JOIN CAR_LOCATION;

SELECT ITEM_NO, CAR_NAME, CAR_FUEL, CAR_GRADE_NAME,
CAR_PASSENGERS, CAR_SLEEP_CAPACITY, CAR_RENT_PRICE, 
(SELECT "CAR_LOCATION_NAME" FROM CAR_LOCATION WHERE CAR_LOCATION_NO= 2) CAR_LOCATION_NAME
FROM CAR NATURAL JOIN ITEM 
NATURAL JOIN CAR_GRADE;

ALTER TABLE ITEM ADD "ITEM_VIEW_COUNT" NUMBER;

ALTER TABLE CAR_STOCK DROP COLUMN "CAR_VIEW_COUNT";
ALTER TABLE CAMP_EQUIPMENT  DROP COLUMN "EQUIPMENT_VIEW_COUNT";

COMMIT;

ALTER TABLE ITEM MODIFY ITEM_VIEW_COUNT DEFAULT 0;

------------------------------------------------------------
SELECT ITEM_NO, CATEGORY_CODE, CATEGORY_NAME, ITEM_VIEW_COUNT , 
      CAR_NAME , CAR_SLEEP_CAPACITY , CAR_PASSENGERS , CAR_RENT_PRICE ,
      CAR_FUEL 
FROM CAR
JOIN ITEM USING (ITEM_NO)
JOIN ITEM_CATEGORY USING (CATEGORY_CODE)
WHERE ITEM_NO IN (SELECT DISTINCT ITEM_NO 
               FROM CAR_STOCK cs 
               WHERE CAR_LOCATION_NO = 1)
ORDER BY ITEM_NO 
;
-------------------------------------------------------------





SELECT * FROM ITEM_IMG ii ;
SELECT * FROM ITEM;
SELECT * FROM CAMP_EQUIPMENT;
SELECT * FROM ITEM_CATEGORY ic ;

SELECT * FROM CAR_STOCK cs ;
SELECT * FROM CAR ;
SELECT * FROM CAR_GRADE cg ;
SELECT * FROM CAR_LOCATION cl ;



CREATE TABLE "RENT" (
	"RENT_NO"	NUMBER		NOT NULL,
	"RENT_DATE"	DATE		NOT NULL,
	"EXPECT_DATE"	DATE		NOT NULL,
	"RENT_DEL_FL"	CHAR(1)	DEFAULT 'N'	NOT NULL,
	"EXPIRE_DATE"	DATE		NULL,
	"MEMBER_NO"	NUMBER		NOT NULL
);

ALTER TABLE RENT MODIFY "EXPIRE_DATE" DEFAULT NULL;

CREATE TABLE "RENT_DETAIL" (
	"RENT_DETAIL_NO"	NUMBER		NOT NULL,
	"RENT_NO"	NUMBER		NOT NULL,
	"ITEM_NO"	NUMBER		NOT NULL,
	"CAR_STOCK_NO"	NUMBER		NULL,
	"RETURN_FL"	CHAR(1)	DEFAULT 'N'	NOT NULL
);

INSERT INTO RENT VALUES (1, '2024-05-31','2024-06-15',DEFAULT, DEFAULT,1);
INSERT INTO RENT VALUES (2, '2024-06-01','2024-06-20',DEFAULT, DEFAULT,1);
INSERT INTO RENT VALUES (3, '2024-06-15','2024-06-20',DEFAULT, DEFAULT,1);
SELECT * FROM ITEM;
SELECT * FROM CAR_STOCK cs ;
INSERT INTO RENT_DETAIL VALUES (1,1,1,1,DEFAULT);
INSERT INTO RENT_DETAIL VALUES (2,2,1,5, DEFAULT);
INSERT INTO RENT_DETAIL VALUES (3,1,2,2,DEFAULT);
INSERT INTO RENT_DETAIL VALUES (4,3,2,4,DEFAULT);

SELECT * FROM RENT_DETAIL;
SELECT * FROM RENT;

COMMIT;

SELECT * 
FROM CAR_STOCK
LEFT JOIN RENT_DETAIL USING (CAR_STOCK_NO)
LEFT JOIN RENT USING (RENT_NO)
WHERE RENT_DATE > '2024-06-14'
OR EXPECT_DATE < '2024-06-01'
OR RENT_DETAIL_NO IS NULL
;

SELECT * FROM MEMBER;
SELECT * FROM RENT;
SELECT * FROM ITEM_IMG ii ;
SELECT * FROM RENT_DETAIL;

SELECT ITEM_NO, CATEGORY_CODE, CATEGORY_NAME, ITEM_VIEW_COUNT , CAR_NAME , 
            CAR_SLEEP_CAPACITY , CAR_PASSENGERS , CAR_RENT_PRICE , CAR_FUEL , 
            IMG_PATH || IMG_RENAME "THUMBNAIL"
      FROM CAR C
      JOIN ITEM USING (ITEM_NO)
      JOIN ITEM_CATEGORY USING (CATEGORY_CODE)
      LEFT JOIN ITEM_IMG USING(ITEM_NO)
      <![CDATA[
         WHERE ITEM_NO IN (SELECT DISTINCT CS.ITEM_NO
                        FROM CAR_STOCK CS
                        LEFT JOIN RENT_DETAIL USING (CAR_STOCK_NO)
                        LEFT JOIN RENT USING (RENT_NO)
                        WHERE (RENT_DATE > '2024-06-14'
                        OR EXPECT_DATE < '2024-06-01'
                        OR RENT_DETAIL_NO IS NULL)
                        AND CAR_LOCATION_NO = 2)
      ]]>
      AND IMG_ORDER = 0            
      ORDER BY ITEM_NO;
     
SELECT * FROM CAR_GRADE;   
 
SELECT ITEM_NO, CAR_NAME, CAR_FUEL, CAR_GRADE_NAME,
CAR_PASSENGERS, CAR_SLEEP_CAPACITY, CAR_RENT_PRICE,
ITEM_VIEW_COUNT, 	
(SELECT IMG_PATH || IMG_RENAME
	 FROM ITEM_IMG
	 WHERE ITEM_NO =1
	 AND   IMG_ORDER = 0) THUMBNAIL
FROM CAR NATURAL JOIN ITEM 
NATURAL JOIN CAR_GRADE
WHERE ITEM_NO = 1;


SELECT * FROM CAR_STOCK cs ;
SELECT * FROM CAMP_EQUIPMENT ce ;
SELECT * FROM ITEM;

INSERT INTO ITEM VALUES (5,2,DEFAULT);
INSERT INTO ITEM VALUES (6,2,DEFAULT);
INSERT INTO ITEM VALUES (7,2,DEFAULT);
INSERT INTO ITEM VALUES (8,2,DEFAULT);

SELECT * FROM EQUIPMENT_CATEGORY ec ;

SELECT EQUIPMENT_NAME, EQUIPMENT_RENT_PRICE, ITEM_VIEW_COUNT, EQUIPMENT_SELL_PRICE ,EQUIPMENT_CATEGORY_NAME
FROM CAMP_EQUIPMENT 
NATURAL JOIN ITEM 
NATURAL JOIN EQUIPMENT_CATEGORY 
WHERE ITEM_NO = 5;

SELECT * FROM "PACKAGE" p ;
SELECT * FROM PACKAGE_DETAIL pd  ;

SELECT PACKAGE_PRICE, PACKAGE_ITEM_COUNT FROM "PACKAGE" 
NATURAL JOIN PACKAGE_DETAIL WHERE PACKAGE_NO = 9;

SELECT PACKAGE_PRICE, PACKAGE_ITEM_COUNT,CAR_GRADE_NAME FROM "PACKAGE"
NATURAL JOIN PACKAGE_DETAIL 
INNER JOIN CAR_GRADE ON() cg  WHERE PACKAGE_NO = 9;

SELECT * FROM ITEM;

ALTER TABLE "PACKAGE_DETAIL" RENAME COLUMN PACKACE_NO TO PACKAGE_NO;
COMMIT;
INSERT INTO "PACKAGE" p VALUES (9,1000000);


		SELECT EQUIPMENT_NAME, EQUIPMENT_CATEGORY_NAME, EQUIPMENT_RENT_PRICE FROM CAMP_EQUIPMENT
		NATURAL JOIN ITEM A
		NATURAL JOIN EQUIPMENT_CATEGORY
		LEFT JOIN PACKAGE ON (A.ITEM_NO = PACKAGE_NO);
